<project name="GUITestInput" default="build">
  <description>InterfaceMapping project build file</description>
	
  <!-- Load build properties -->
  <target name="properties" >
  	<property file="build.properties" />
  </target>

  <!-- Clean up -->
  <target name="clean" depends="properties" description="clean up">
  	<delete includeemptydirs="true" quiet="true">
      <fileset dir="${build.dir}"/>
  	</delete>
    <delete includeemptydirs="true" quiet="true">
      <fileset dir="${src.dir}"/>
  	</delete>
  	<delete includeemptydirs="true" quiet="true">
  	  <fileset dir="${dist.dir}"/>
  	</delete>
  </target>
	
  <!-- Initialize paths -->
  <target name="init" depends="clean">
    <path id="classpath" > 
    	<fileset dir="${lib.dir}" />   		
    </path>
  	<mkdir dir="${src.dir}" />
  	<mkdir dir="${build.dir}" />
  	<mkdir dir="${dist.dir}" />
  </target>

  <!-- Compile and package in jar -->
  <target name="build" depends="jar">
  	<antcall target="copy-dependency-libs" />
  </target>

  <!-- Compile source generated by compilation of xml schemas -->
  <target name="compile" depends="jaxb">
    <javac destdir="${build.dir}" debug="${build.debug}" debuglevel="${build.debuglevel}" optimize="${build.optimize}" deprecation="${build.deprecation}" srcdir="${src.dir}">
      <classpath refid="classpath" />
    </javac>
  </target>

  <!-- Package compiled files in jar -->
  <target name="jar" depends="copy">
    <jar jarfile="${dist.dir}/${jar.filename}">
      <fileset dir="${build.dir}">
        <exclude name="**/build.*"/>
      </fileset>
    </jar>
  </target>

  <!-- Copy JAXB properties files -->
  <target name="copy" depends="compile">
    <copy todir="${build.dir}">
      <fileset dir="${src.dir}">
        <exclude name="**/*.java"/>
      </fileset>
    </copy>
  </target>
	
  <!-- Copy all jars that GUITestInput depends on in the dist folder -->
  <target name="copy-dependency-libs" >
    <copy todir="${dist.dir}">
      <fileset dir="${lib.dir}">
	    <include name="**/${jar.filename}"/>
      	<include name="**/jaxb-api.jar"/>
      	<include name="**/jaxb-impl.jar"/>
      	<include name="**/jaxb1-impl.jar"/>
      </fileset>
    </copy>
  </target>
	
  <!-- Compile xml schema -->
  <target name="jaxb" depends="init" >
  	<taskdef name="xjc" classname="com.sun.tools.xjc.XJCTask" >
  		<classpath refid="classpath" />
  	</taskdef>
    <xjc target="${src.dir}" package="${package.generated}" source="2.0">
  	  <schema dir="${schema.dir}">
    	<include name="${schema.file}" />
      </schema>
	  <arg value="-nv" />
      <arg value="-extension" />
	</xjc>
 </target>
	
</project>